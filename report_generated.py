file = ""


def text_file_creator(path):
    global file
    with open(path, 'w'):
        pass
    file = path
    print("Empty File Created Successfully For Report")


def vulnerability_add(domain, method, parameter, payload, vuln):
    global file
    with open(file, 'a') as the_file:
        the_file.write('\n')
        if vuln == "xss":
            url = domain + "?" + parameter + "=" + payload
            line = "XSS Injection: " + "Method -> " + method + ", URL => " + url
            the_file.write(line)

        elif vuln == "sql":
            url = domain
            line = "SQL Injection: " + "Url=>" + url + ", Method ->" + method + ", Parameter =>" + parameter + ", Payload =>" + payload
            the_file.write(line)

        elif vuln == "crlf":
            url = domain
            line = "CRLF Injection: " + "Url=> " + url + ", Payload =>" + payload
            the_file.write(line)

        elif vuln == "command":
            url = domain
            line = "Command Injection: " + "Url=> " + url + ", Method ->" + method + ", Parameter =>" + parameter + ", Payload =>" + payload
            the_file.write(line)

    print("Vulnerability Added Successfully")
    the_file.close()  # close the file
